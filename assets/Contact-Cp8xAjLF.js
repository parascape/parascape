import{W as S,Y as o,r as j,Z as R,j as e,_ as T,$ as q,a0 as w,a1 as E}from"./vendor-BeURxZ8R.js";import{a as C,N as P}from"./features-9S1xDljV.js";import{F as k,c as i,d as l,e as c,f as m,I as d,g as u,h as B,B as I}from"./ui-CqmGlQa7.js";const A=S({name:o().min(2,"Name must be at least 2 characters"),email:o().email("Please enter a valid email address"),business:o().min(1,"Business name is required"),phone:o().optional(),about:o().min(10,"Message must be at least 10 characters"),honeypot:o().optional()}),f=3,N=1e3;function L({type:h}){const[x,y]=j.useState(!1),[b,F]=j.useState(0),t=R({resolver:q(A),defaultValues:{name:"",email:"",business:"",phone:"",about:"",honeypot:""}}),r=h==="audit";j.useEffect(()=>{console.log("ContactForm: isAuditRequest =",r),r&&t.setValue("about","I would like to request a free digital presence audit for my business.")},[r,t]);const g=s=>new Promise(a=>setTimeout(a,s));async function p(s,a=0){try{const n=await fetch("https://hjhpcawffvgcczhxcjsr.supabase.co/functions/v1/handle-form-submission",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"},body:JSON.stringify({...s,type:r?"audit_request":"contact"})});return!n.ok&&a<f?(await g(N*Math.pow(2,a)),p(s,a+1)):n}catch(n){if(a<f)return await g(N*Math.pow(2,a)),p(s,a+1);throw n}}async function v(s){if(!x){y(!0);try{const a=await p(s);if(!a.ok){const n=await a.json();throw new Error(n.message||"Failed to submit form")}C.track({name:"form_submission",properties:{form:r?"audit_request":"contact",business:s.business}}),w.success(r?"Thank you! We'll send your audit within 24 hours.":"Thank you for your message! We'll be in touch soon."),t.reset()}catch(a){w.error(a instanceof Error?a.message:"Something went wrong. Please try again."),console.error("Form submission error:",a)}finally{y(!1),F(0)}}}return e.jsxs("div",{className:"w-full max-w-xl mx-auto p-6 space-y-8 bg-white rounded-lg shadow-lg animate-fade-up",children:[e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight text-parascape-green",children:r?"Request Your Free Audit":"Get in Touch"}),e.jsx("p",{className:"text-gray-500",children:r?"We'll analyze your digital presence and provide actionable insights.":"Ready to transform your business? Let's start a conversation."}),e.jsx("p",{className:"text-sm text-gray-400",children:"* Required fields"})]}),e.jsx(k,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(v),className:"space-y-6",children:[e.jsx(i,{control:t.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Name *"}),e.jsx(m,{children:e.jsx(d,{placeholder:"John Doe",...s,"aria-required":"true",autoComplete:"name"})}),e.jsx(u,{})]})}),e.jsx(i,{control:t.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Email *"}),e.jsx(m,{children:e.jsx(d,{type:"email",placeholder:"john@example.com",...s,"aria-required":"true",autoComplete:"email"})}),e.jsx(u,{})]})}),e.jsx(i,{control:t.control,name:"business",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Business Name *"}),e.jsx(m,{children:e.jsx(d,{placeholder:"Your Business LLC",...s,"aria-required":"true",autoComplete:"organization"})}),e.jsx(u,{})]})}),e.jsx(i,{control:t.control,name:"phone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Phone"}),e.jsx(m,{children:e.jsx(d,{type:"tel",placeholder:"(555) 123-4567",...s,autoComplete:"tel"})}),e.jsx(u,{}),e.jsx("p",{className:"text-xs text-gray-500",children:"Optional, but recommended for faster communication"})]})}),e.jsx(i,{control:t.control,name:"about",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Message *"}),e.jsx(m,{children:e.jsx(B,{placeholder:"Tell us about your business goals and how we can help...",className:"min-h-[120px]",...s,"aria-required":"true"})}),e.jsx(u,{})]})}),e.jsx("input",{type:"text",tabIndex:-1,...t.register("honeypot"),style:{position:"absolute",left:"-9999px"},"aria-hidden":"true"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["By submitting this form, you agree to our"," ",e.jsx("a",{href:"/privacy",className:"text-parascape-green hover:underline",children:"Privacy Policy"})]}),e.jsx(I,{type:"submit",className:"w-full bg-parascape-green hover:bg-parascape-green/90 transition-all duration-200 transform hover:scale-[1.02]",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),b>0?`Retrying... (${b}/${f})`:"Submitting..."]}):"Start Your Digital Transformation"})]})]})})]})}const W=()=>{const{type:h}=E();return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(P,{}),e.jsx("div",{className:"pt-24 pb-12",children:e.jsx(L,{type:h})})]})};export{W as default};
